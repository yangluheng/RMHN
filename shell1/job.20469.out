2022-05-14 11:27:34
开始时间： 2022-05-14 11:27:34
正在执行DBP15k
加载数据文件：data/DBP15k/ja_en/ent_ids_1
加载数据文件：data/DBP15k/ja_en/ent_ids_2
39594
加载数据文件：data/DBP15k/ja_en/ref_ent_ids
加载数据文件：data/DBP15k/ja_en/ref_r_ids
加载数据文件：data/DBP15k/ja_en/triples_1
加载数据文件：data/DBP15k/ja_en/triples_2
建立模型：
开始时间： 2022-05-14 11:27:35
计算头尾实体对应关系的矩阵以及对应概率：
开始时间： 2022-05-14 11:27:35
结束时间： 2022-05-14 11:27:36
用时 0:00:01.015677
输入词向量，增加原始输入层：
开始时间： 2022-05-14 11:27:36
39594 rows, 300 columns.
结束时间： 2022-05-14 11:27:45
用时 0:00:09.277474
计算稀疏张量和对称归一化后的矩阵：
开始时间： 2022-05-14 11:27:45
获取反转图，邻接矩阵、度、丰富三元组：
开始时间： 2022-05-14 11:27:45
结束时间： 2022-05-14 11:27:46
用时 0:00:00.330264
计算三角：
开始时间： 2022-05-14 11:28:06
结束时间： 2022-05-14 11:28:07
用时 0:00:01.158133
计算三角：
开始时间： 2022-05-14 11:28:07
结束时间： 2022-05-14 11:28:08
用时 0:00:01.146017
M2 SparseTensor(indices=Tensor("SparseTensor_1/indices:0", shape=(269696, 2), dtype=int64), values=Tensor("SparseTensor_1/values:0", shape=(269696,), dtype=float32), dense_shape=Tensor("SparseTensor_1/dense_shape:0", shape=(2,), dtype=int64))
结束时间： 2022-05-14 11:28:08
用时 0:00:22.630930
KG structure embedding
增加GCN层：
开始时间： 2022-05-14 11:28:09
<tf.Variable 'Variable_1:0' shape=(1, 300) dtype=float32_ref>
结束时间： 2022-05-14 11:28:09
用时 0:00:00.006764
实现SKNet：
开始时间： 2022-05-14 11:28:09
结束时间： 2022-05-14 11:28:09
用时 0:00:00.006459
增加GCN层：
开始时间： 2022-05-14 11:28:09
<tf.Variable 'Variable_4:0' shape=(1, 300) dtype=float32_ref>
结束时间： 2022-05-14 11:28:09
用时 0:00:00.002033
实现SKNet：
开始时间： 2022-05-14 11:28:09
结束时间： 2022-05-14 11:28:09
用时 0:00:00.005847
shape of output_h:  (39594, 300)
compute pre-training loss
计算预训练损失函数：
开始时间： 2022-05-14 11:28:09
Tensor("strided_slice:0", shape=(?,), dtype=int32) Tensor("strided_slice_1:0", shape=(?,), dtype=int32)
Tensor("embedding_lookup/Identity:0", shape=(?, 300), dtype=float32) Tensor("embedding_lookup_1/Identity:0", shape=(?, 300), dtype=float32)
结束时间： 2022-05-14 11:28:09
用时 0:00:00.014358
输入词向量，增加原始输入层：
开始时间： 2022-05-14 11:28:09
2452 rows, 300 columns.
2452
(2452, 300)
计算关系的向量：
开始时间： 2022-05-14 11:28:17
结束时间： 2022-05-14 11:28:21
用时 0:00:04.140144
Tensor("Add_13:0", shape=(4904, 300), dtype=float32)
结束时间： 2022-05-14 11:28:21
用时 0:00:12.046996
计算关系损失函数：
开始时间： 2022-05-14 11:28:21
结束时间： 2022-05-14 11:28:21
用时 0:00:00.005404
结束时间： 2022-05-14 11:28:21
用时 0:00:46.664960
初始化：
开始时间： 2022-05-14 11:28:22
开始运行：
开始训练：第1 epoch
数据准备：
负采样：
开始时间： 2022-05-14 11:34:27
结束时间： 2022-05-14 11:35:49
用时 0:01:22.052022
负采样：
开始时间： 2022-05-14 11:35:49
结束时间： 2022-05-14 11:37:05
用时 0:01:16.265353
1/30 epochs...
用时： 0:04:30.933341
开始训练：第2 epoch
用时： 0:00:02.722718
开始训练：第3 epoch
用时： 0:00:02.726464
开始训练：第4 epoch
用时： 0:00:02.726069
开始训练：第5 epoch
用时： 0:00:02.732828
开始训练：第6 epoch
用时： 0:00:02.739919
开始训练：第7 epoch
用时： 0:00:02.734299
开始训练：第8 epoch
用时： 0:00:02.738964
开始训练：第9 epoch
用时： 0:00:02.747419
开始训练：第10 epoch
10/30 epochs...
用时： 0:00:02.750733
开始训练：第11 epoch
用时： 0:00:02.745429
开始训练：第12 epoch
用时： 0:00:02.744263
开始训练：第13 epoch
用时： 0:00:02.746442
开始训练：第14 epoch
用时： 0:00:02.740972
开始训练：第15 epoch
用时： 0:00:02.733432
开始训练：第16 epoch
用时： 0:00:02.738379
开始训练：第17 epoch
用时： 0:00:02.737051
开始训练：第18 epoch
用时： 0:00:02.737084
开始训练：第19 epoch
用时： 0:00:02.743970
开始训练：第20 epoch
20/30 epochs...
Save to path:  HTRS_model/save_DBP15k_ja_en.ckpt
用时： 0:00:36.385849
开始训练：第21 epoch
数据准备：
负采样：
开始时间： 2022-05-14 11:38:38
结束时间： 2022-05-14 11:39:55
用时 0:01:16.255823
负采样：
开始时间： 2022-05-14 11:39:55
结束时间： 2022-05-14 11:41:11
用时 0:01:16.360556
用时： 0:04:51.072567
开始训练：第22 epoch
用时： 0:00:16.219271
开始训练：第23 epoch
用时： 0:00:16.272474
开始训练：第24 epoch
用时： 0:00:16.178119
开始训练：第25 epoch
用时： 0:00:16.167444
开始训练：第26 epoch
用时： 0:00:16.265806
开始训练：第27 epoch
用时： 0:00:16.289137
开始训练：第28 epoch
用时： 0:00:16.270618
开始训练：第29 epoch
用时： 0:00:16.270112
开始训练：第30 epoch
30/30 epochs...
Testing
Test set results:
iter: 1
开始时间： 2022-05-14 11:46:42
实体sim [[3.42488869 5.58136007 6.38288407 ... 5.49122556 5.07368873 6.76632867]
 [5.99155489 2.98672347 6.81725958 ... 6.17636048 5.89984127 6.41724782]
 [6.63387861 6.20256239 1.21052057 ... 6.51848037 6.08010723 7.77533128]
 ...
 [5.99563631 5.85648499 6.47723938 ... 0.60411173 5.17545625 7.36932227]
 [5.24662396 5.27391764 6.11603151 ... 4.94299649 1.94206877 6.53988745]
 [7.53172134 6.20974863 7.84156568 ... 7.60415175 6.72729704 1.18251926]]
关系sim [[32.66673219 30.70429211 28.96540184 ... 29.97847276 27.57271051
  32.18299083]
 [31.77553164 29.95401416 26.30038084 ... 27.97265248 30.79817657
  33.87995854]
 [34.51749452 31.36501384 29.87491518 ... 31.30510325 32.1945947
  36.6902003 ]
 ...
 [33.75527161 31.42680851 31.08846262 ... 31.87578666 29.53352364
  31.85672427]
 [32.48479001 31.62095524 28.59743727 ... 29.8440638  30.49534164
  32.92859328]
 [33.39397049 29.94977961 31.45563973 ... 30.94612587 30.59987036
  33.11724791]]
[[32.66673219 30.70429211 28.96540184 ... 29.97847276 27.57271051
  32.18299083]
 [31.77553164 29.95401416 26.30038084 ... 27.97265248 30.79817657
  33.87995854]
 [34.51749452 31.36501384 29.87491518 ... 31.30510325 32.1945947
  36.6902003 ]
 ...
 [33.75527161 31.42680851 31.08846262 ... 31.87578666 29.53352364
  31.85672427]
 [32.48479001 31.62095524 28.59743727 ... 29.8440638  30.49534164
  32.92859328]
 [33.39397049 29.94977961 31.45563973 ... 30.94612587 30.59987036
  33.11724791]]
Entity Alignment (left):
Hits@1: 78.12%
Hits@3: 84.95%
Hits@10: 89.50%
MRR: 0.8221
MR: 53.5062
Entity Alignment (right):
Hits@1: 76.62%
Hits@3: 84.10%
Hits@10: 89.53%
MRR: 0.8124
MR: 42.4957
结束时间： 2022-05-14 11:54:11
用时 0:07:28.463946
iter: 2
开始时间： 2022-05-14 11:54:11
实体sim [[3.42488869 5.58136007 6.38288407 ... 5.49122556 5.07368873 6.76632867]
 [5.99155489 2.98672347 6.81725958 ... 6.17636048 5.89984127 6.41724782]
 [6.63387861 6.20256239 1.21052057 ... 6.51848037 6.08010723 7.77533128]
 ...
 [5.99563631 5.85648499 6.47723938 ... 0.60411173 5.17545625 7.36932227]
 [5.24662396 5.27391764 6.11603151 ... 4.94299649 1.94206877 6.53988745]
 [7.53172134 6.20974863 7.84156568 ... 7.60415175 6.72729704 1.18251926]]
关系sim [[32.66673219 30.70429211 28.96540184 ... 29.97847276 27.57271051
  32.18299083]
 [31.77553164 29.95401416 26.30038084 ... 27.97265248 30.79817657
  33.87995854]
 [34.51749452 31.36501384 29.87491518 ... 31.30510325 32.1945947
  36.6902003 ]
 ...
 [33.75527161 31.42680851 31.08846262 ... 31.87578666 29.53352364
  31.85672427]
 [32.48479001 31.62095524 28.59743727 ... 29.8440638  30.49534164
  32.92859328]
 [33.39397049 29.94977961 31.45563973 ... 30.94612587 30.59987036
  33.11724791]]
[[32.66673219 30.70429211 28.96540184 ... 29.97847276 27.57271051
  32.18299083]
 [31.77553164 29.95401416 26.30038084 ... 27.97265248 30.79817657
  33.87995854]
 [34.51749452 31.36501384 29.87491518 ... 31.30510325 32.1945947
  36.6902003 ]
 ...
 [33.75527161 31.42680851 31.08846262 ... 31.87578666 29.53352364
  31.85672427]
 [32.48479001 31.62095524 28.59743727 ... 29.8440638  30.49534164
  32.92859328]
 [33.39397049 29.94977961 31.45563973 ... 30.94612587 30.59987036
  33.11724791]]
Entity Alignment (left):
Hits@1: 86.26%
Hits@3: 91.05%
Hits@10: 93.72%
MRR: 0.8900
MR: 49.0224
Entity Alignment (right):
Hits@1: 85.34%
Hits@3: 90.30%
Hits@10: 93.61%
MRR: 0.8830
MR: 35.1805
结束时间： 2022-05-14 12:01:43
用时 0:07:32.054509
开始时间： 2022-05-14 12:01:43
2022-05-14 12:01:43
[[3.42488869 5.58136007 6.38288407 ... 5.49122556 5.07368873 6.76632867]
 [5.99155489 2.98672347 6.81725958 ... 6.17636048 5.89984127 6.41724782]
 [6.63387861 6.20256239 1.21052057 ... 6.51848037 6.08010723 7.77533128]
 ...
 [5.99563631 5.85648499 6.47723938 ... 0.60411173 5.17545625 7.36932227]
 [5.24662396 5.27391764 6.11603151 ... 4.94299649 1.94206877 6.53988745]
 [7.53172134 6.20974863 7.84156568 ... 7.60415175 6.72729704 1.18251926]]
Relation Alignment (left):
Hits@1: 76.37%
Hits@10: 85.44%
Relation Alignment (right):
Hits@1: 72.78%
Hits@10: 82.42%
结束时间： 2022-05-14 12:05:16
用时 0:03:32.409219
用时： 0:19:36.415523
结束时间： 2022-05-14 12:05:16
用时 0:36:54.125981
结束时间： 2022-05-14 12:05:16
用时 0:37:41.748489
